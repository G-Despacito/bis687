cat("Mean DQI score for smoking_status_f20116_0_0 = 0:", mean_0, "\n")
cat("Mean DQI score for smoking_status_f20116_0_0 = 1:", mean_1, "\n\n")
wilcox.test(df$DQI_score[df$smoking_status_f20116_0_0 == 0], df$DQI_score[df$smoking_status_f20116_0_0 == 1], alternative = "two.sided")
#----------------- Linear Regression -------------------#
cat("\n\n#----------------- Linear Regression -------------------#\n\n")
# fit a multivariable linear regression model
model <- lm(DQI_score ~ screen_time + sex_f31_0_0 + age_at_recruitment_f21022_0_0 +
total_met_minites_per_day + sleep_duration_f1160_0_0 + alcohol_intake_frequency_f1558_0_0 +
standing_height_f50_0_0 + weight_f21002_0_0 + frequency_of_friendfamily_visits_f1031_0_0 +
smoking_status_f20116_0_0, data = df)
# display the regression
cat("Analysis Results\n")
summary(model)
sink()
#----------------- Descriptive Statistics -------------------#
cat("\n\n#----------------- Descriptive Statistics -------------------#\n\n")
library(psych)
# subset the data by screen_time
screen0 <- subset(df, screen_time == 0)
screen1 <- subset(df, screen_time == 1)
# calculate descriptive statistics for screen_time=0
screen_time_0_desc <- describe(screen0[c("age_at_recruitment_f21022_0_0",
"total_met_minites_per_day",
"DQI_score",
"total_screen_hours_per_day",
"sleep_duration_f1160_0_0",
"alcohol_intake_frequency_f1558_0_0",
"standing_height_f50_0_0",
"weight_f21002_0_0",
"frequency_of_friendfamily_visits_f1031_0_0",
"smoking_status_f20116_0_0")])
# calculate descriptive statistics for screen_time=1
screen_time_1_desc <- describe(screen1[c("age_at_recruitment_f21022_0_0",
"total_met_minites_per_day",
"DQI_score",
"total_screen_hours_per_day",
"sleep_duration_f1160_0_0",
"alcohol_intake_frequency_f1558_0_0",
"standing_height_f50_0_0",
"weight_f21002_0_0",
"frequency_of_friendfamily_visits_f1031_0_0",
"smoking_status_f20116_0_0")])
# calculate percentage of females in each group
percent_female_0 <- round(prop.table(table(screen0$sex_f31_0_0))["0"] * 100, 2)
percent_female_1 <- round(prop.table(table(screen1$sex_f31_0_0))["0"] * 100, 2)
# calculate descriptive statistics for screen_time=1
screen_time_desc <- describeBy(df[c("age_at_recruitment_f21022_0_0",
"total_met_minites_per_day",
"DQI_score",
"total_screen_hours_per_day",
"sleep_duration_f1160_0_0",
"alcohol_intake_frequency_f1558_0_0",
"standing_height_f50_0_0",
"weight_f21002_0_0",
"frequency_of_friendfamily_visits_f1031_0_0",
"smoking_status_f20116_0_0")],
df$screen_time,
mat=TRUE,
digits=2,
fast=TRUE)
# print the table and percentage of females
sink("aim1_results.txt")
cat("Group 0: screen time < 4hr per day \n")
cat("Group 1: screen time > 4hr per day \n")
screen_time_desc[, c(2, 4, 5, 6)] # display only mean and sd columns
cat("Group 0: Percentage of females: ", percent_female_0, "% \n")
cat("Group 1: Percentage of females: ", percent_female_1, "% \n")
#----------------- Hypothesis Testing -------------------#
cat("\n\n#----------------- Hypothesis Testing -------------------#\n\n")
cat("\n\n#------------ Any DQI_score differences between screen_time=0,1? --------------#\n\n")
hist(df$DQI_score)
# check normality using Kolmogorov-Smirnov test
ks.test(df$DQI_score, "pnorm", mean(df$DQI_score), sd(df$DQI_score))
# calculate the mean DQI score for each group
mean_0 <- mean(df$DQI_score[df$screen_time == 0])
mean_1 <- mean(df$DQI_score[df$screen_time == 1])
# print the mean DQI score for each group
cat("Mean DQI score for screen_time = 0:", mean_0, "\n")
cat("Mean DQI score for screen_time = 1:", mean_1, "\n\n")
# conduct Mann-Whitney U test and save the results to a local file
wilcox.test(df$DQI_score[df$screen_time == 0], df$DQI_score[df$screen_time == 1], alternative = "two.sided")
cat("\n\n#------------ Any DQI_score differences between sex=0,1? --------------#\n\n")
mean_0 <- mean(df$DQI_score[df$sex_f31_0_0 == 0])
mean_1 <- mean(df$DQI_score[df$sex_f31_0_0 == 1])
cat("Mean DQI score for sex_f31_0_0 = 0:", mean_0, "\n")
cat("Mean DQI score for sex_f31_0_0 = 1:", mean_1, "\n\n")
wilcox.test(df$DQI_score[df$sex_f31_0_0 == 0], df$DQI_score[df$sex_f31_0_0 == 1], alternative = "two.sided")
cat("\n\n#------------ Any DQI_score differences between smoking status=0,1? --------------#\n\n")
mean_0 <- mean(df$DQI_score[df$smoking_status_f20116_0_0 == 0])
mean_1 <- mean(df$DQI_score[df$smoking_status_f20116_0_0 == 1])
cat("Mean DQI score for smoking_status_f20116_0_0 = 0:", mean_0, "\n")
cat("Mean DQI score for smoking_status_f20116_0_0 = 1:", mean_1, "\n\n")
wilcox.test(df$DQI_score[df$smoking_status_f20116_0_0 == 0], df$DQI_score[df$smoking_status_f20116_0_0 == 1], alternative = "two.sided")
#----------------- Linear Regression -------------------#
cat("\n\n#----------------- Linear Regression -------------------#\n\n")
# fit a multivariable linear regression model
model <- lm(DQI_score ~ screen_time + sex_f31_0_0 + age_at_recruitment_f21022_0_0 +
total_met_minites_per_day + sleep_duration_f1160_0_0 + alcohol_intake_frequency_f1558_0_0 +
standing_height_f50_0_0 + weight_f21002_0_0 + frequency_of_friendfamily_visits_f1031_0_0 +
smoking_status_f20116_0_0, data = df)
# display the regression
cat("Analysis Results\n")
summary(model)
sink()
#----------------- Descriptive Statistics -------------------#
cat("\n\n#----------------- Descriptive Statistics -------------------#\n\n")
library(psych)
# subset the data by screen_time
screen0 <- subset(df, screen_time == 0)
screen1 <- subset(df, screen_time == 1)
# calculate descriptive statistics for screen_time=0
screen_time_0_desc <- describe(screen0[c("age_at_recruitment_f21022_0_0",
"total_met_minites_per_day",
"DQI_score",
"total_screen_hours_per_day",
"sleep_duration_f1160_0_0",
"alcohol_intake_frequency_f1558_0_0",
"standing_height_f50_0_0",
"weight_f21002_0_0",
"frequency_of_friendfamily_visits_f1031_0_0")])
# calculate descriptive statistics for screen_time=1
screen_time_1_desc <- describe(screen1[c("age_at_recruitment_f21022_0_0",
"total_met_minites_per_day",
"DQI_score",
"total_screen_hours_per_day",
"sleep_duration_f1160_0_0",
"alcohol_intake_frequency_f1558_0_0",
"standing_height_f50_0_0",
"weight_f21002_0_0",
"frequency_of_friendfamily_visits_f1031_0_0")])
# calculate percentage of females and smoke status in each group
percent_female_0 <- round(prop.table(table(screen0$sex_f31_0_0))["0"] * 100, 2)
percent_female_1 <- round(prop.table(table(screen1$sex_f31_0_0))["0"] * 100, 2)
percent_never_smoke_0 <- round(prop.table(table(screen0$smoking_status_f20116_0_0))["0"] * 100, 2)
percent_never_smoke_1 <- round(prop.table(table(screen1$smoking_status_f20116_0_0))["0"] * 100, 2)
percent_previous_smoke_0 <- round(prop.table(table(screen0$smoking_status_f20116_0_0))["1"] * 100, 2)
percent_previous_smoke_1 <- round(prop.table(table(screen1$smoking_status_f20116_0_0))["1"] * 100, 2)
percent_current_smoke_0 <- round(prop.table(table(screen0$smoking_status_f20116_0_0))["2"] * 100, 2)
percent_current_smoke_1 <- round(prop.table(table(screen1$smoking_status_f20116_0_0))["2"] * 100, 2)
# calculate descriptive statistics for screen_time=1
screen_time_desc <- describeBy(df[c("age_at_recruitment_f21022_0_0",
"total_met_minites_per_day",
"DQI_score",
"total_screen_hours_per_day",
"sleep_duration_f1160_0_0",
"alcohol_intake_frequency_f1558_0_0",
"standing_height_f50_0_0",
"weight_f21002_0_0",
"frequency_of_friendfamily_visits_f1031_0_0")],
df$screen_time,
mat=TRUE,
digits=2,
fast=TRUE)
# print the table and percentage of females
sink("aim1_results.txt")
cat("Group 0: screen time < 4hr per day \n")
cat("Group 1: screen time > 4hr per day \n")
screen_time_desc[, c(2, 4, 5, 6)] # display only mean and sd columns
cat("Group 0: Percentage of females: ", percent_female_0, "% \n")
cat("Group 1: Percentage of females: ", percent_female_1, "% \n")
cat("Group 0: Percentage of never smoke: ", percent_never_smoke_0, "% \n")
cat("Group 1: Percentage of never smoke: ", percent_never_smoke_1, "% \n")
cat("Group 0: Percentage of previous smoke: ", percent_previous_smoke_0, "% \n")
cat("Group 1: Percentage of previous smoke: ", percent_previous_smoke_1, "% \n")
cat("Group 0: Percentage of current smoke: ", percent_current_smoke_0, "% \n")
cat("Group 1: Percentage of current smoke: ", percent_current_smoke_1, "% \n")
#----------------- Hypothesis Testing -------------------#
cat("\n\n#----------------- Hypothesis Testing -------------------#\n\n")
cat("\n\n#------------ Any DQI_score differences between screen_time=0,1? --------------#\n\n")
hist(df$DQI_score)
# check normality using Kolmogorov-Smirnov test
ks.test(df$DQI_score, "pnorm", mean(df$DQI_score), sd(df$DQI_score))
# calculate the mean DQI score for each group
mean_0 <- mean(df$DQI_score[df$screen_time == 0])
mean_1 <- mean(df$DQI_score[df$screen_time == 1])
# print the mean DQI score for each group
cat("Mean DQI score for screen_time = 0:", mean_0, "\n")
cat("Mean DQI score for screen_time = 1:", mean_1, "\n\n")
# conduct Mann-Whitney U test and save the results to a local file
wilcox.test(df$DQI_score[df$screen_time == 0], df$DQI_score[df$screen_time == 1], alternative = "two.sided")
cat("\n\n#------------ Any DQI_score differences between sex=0,1? --------------#\n\n")
mean_0 <- mean(df$DQI_score[df$sex_f31_0_0 == 0])
mean_1 <- mean(df$DQI_score[df$sex_f31_0_0 == 1])
cat("Mean DQI score for sex_f31_0_0 = 0:", mean_0, "\n")
cat("Mean DQI score for sex_f31_0_0 = 1:", mean_1, "\n\n")
wilcox.test(df$DQI_score[df$sex_f31_0_0 == 0], df$DQI_score[df$sex_f31_0_0 == 1], alternative = "two.sided")
cat("\n\n#------------ Any DQI_score differences between smoking status=0,1? --------------#\n\n")
mean_0 <- mean(df$DQI_score[df$smoking_status_f20116_0_0 == 0])
mean_1 <- mean(df$DQI_score[df$smoking_status_f20116_0_0 == 1])
cat("Mean DQI score for smoking_status_f20116_0_0 = 0:", mean_0, "\n")
cat("Mean DQI score for smoking_status_f20116_0_0 = 1:", mean_1, "\n\n")
wilcox.test(df$DQI_score[df$smoking_status_f20116_0_0 == 0], df$DQI_score[df$smoking_status_f20116_0_0 == 1], alternative = "two.sided")
#----------------- Linear Regression -------------------#
cat("\n\n#----------------- Linear Regression -------------------#\n\n")
# fit a multivariable linear regression model
model <- lm(DQI_score ~ screen_time + sex_f31_0_0 + age_at_recruitment_f21022_0_0 +
total_met_minites_per_day + sleep_duration_f1160_0_0 + alcohol_intake_frequency_f1558_0_0 +
standing_height_f50_0_0 + weight_f21002_0_0 + frequency_of_friendfamily_visits_f1031_0_0 +
smoking_status_f20116_0_0, data = df)
# display the regression
cat("Analysis Results\n")
summary(model)
sink()
#----------------- Descriptive Statistics -------------------#
cat("\n\n#----------------- Descriptive Statistics -------------------#\n\n")
library(psych)
# subset the data by screen_time
screen0 <- subset(df, screen_time == 0)
screen1 <- subset(df, screen_time == 1)
# calculate descriptive statistics for screen_time=0
screen_time_0_desc <- describe(screen0[c("age_at_recruitment_f21022_0_0",
"total_met_minites_per_day",
"DQI_score",
"total_screen_hours_per_day",
"sleep_duration_f1160_0_0",
"alcohol_intake_frequency_f1558_0_0",
"standing_height_f50_0_0",
"weight_f21002_0_0",
"frequency_of_friendfamily_visits_f1031_0_0")])
# calculate descriptive statistics for screen_time=1
screen_time_1_desc <- describe(screen1[c("age_at_recruitment_f21022_0_0",
"total_met_minites_per_day",
"DQI_score",
"total_screen_hours_per_day",
"sleep_duration_f1160_0_0",
"alcohol_intake_frequency_f1558_0_0",
"standing_height_f50_0_0",
"weight_f21002_0_0",
"frequency_of_friendfamily_visits_f1031_0_0")])
# calculate percentage of females and smoke status in each group
percent_female_0 <- round(prop.table(table(screen0$sex_f31_0_0))["0"] * 100, 2)
percent_female_1 <- round(prop.table(table(screen1$sex_f31_0_0))["0"] * 100, 2)
percent_never_smoke_0 <- round(prop.table(table(screen0$smoking_status_f20116_0_0))["0"] * 100, 2)
percent_never_smoke_1 <- round(prop.table(table(screen1$smoking_status_f20116_0_0))["0"] * 100, 2)
percent_previous_smoke_0 <- round(prop.table(table(screen0$smoking_status_f20116_0_0))["1"] * 100, 2)
percent_previous_smoke_1 <- round(prop.table(table(screen1$smoking_status_f20116_0_0))["1"] * 100, 2)
percent_current_smoke_0 <- round(prop.table(table(screen0$smoking_status_f20116_0_0))["2"] * 100, 2)
percent_current_smoke_1 <- round(prop.table(table(screen1$smoking_status_f20116_0_0))["2"] * 100, 2)
# calculate descriptive statistics for screen_time=1
screen_time_desc <- describeBy(df[c("age_at_recruitment_f21022_0_0",
"total_met_minites_per_day",
"DQI_score",
"total_screen_hours_per_day",
"sleep_duration_f1160_0_0",
"alcohol_intake_frequency_f1558_0_0",
"standing_height_f50_0_0",
"weight_f21002_0_0",
"frequency_of_friendfamily_visits_f1031_0_0")],
df$screen_time,
mat=TRUE,
digits=2,
fast=TRUE)
# print the table and percentage of females
sink("aim1_results.txt")
cat("Group 0: screen time < 4hr per day \n")
cat("Group 1: screen time > 4hr per day \n")
screen_time_desc[, c(2, 4, 5, 6)] # display only mean and sd columns
cat("Group 0: Percentage of females: ", percent_female_0, "% \n")
cat("Group 1: Percentage of females: ", percent_female_1, "% \n")
cat("Group 0: Percentage of never smoke: ", percent_never_smoke_0, "% \n")
cat("Group 1: Percentage of never smoke: ", percent_never_smoke_1, "% \n")
cat("Group 0: Percentage of previous smoke: ", percent_previous_smoke_0, "% \n")
cat("Group 1: Percentage of previous smoke: ", percent_previous_smoke_1, "% \n")
cat("Group 0: Percentage of current smoke: ", percent_current_smoke_0, "% \n")
cat("Group 1: Percentage of current smoke: ", percent_current_smoke_1, "% \n")
#----------------- Hypothesis Testing -------------------#
cat("\n\n#----------------- Hypothesis Testing -------------------#\n\n")
cat("\n\n#------------ Any DQI_score differences between screen_time=0,1? --------------#\n\n")
hist(df$DQI_score)
# check normality using Kolmogorov-Smirnov test
ks.test(df$DQI_score, "pnorm", mean(df$DQI_score), sd(df$DQI_score))
# calculate the mean DQI score for each group
mean_0 <- mean(df$DQI_score[df$screen_time == 0])
mean_1 <- mean(df$DQI_score[df$screen_time == 1])
# print the mean DQI score for each group
cat("Mean DQI score for screen_time = 0:", mean_0, "\n")
cat("Mean DQI score for screen_time = 1:", mean_1, "\n\n")
# conduct Mann-Whitney U test and save the results to a local file
wilcox.test(df$DQI_score[df$screen_time == 0], df$DQI_score[df$screen_time == 1], alternative = "two.sided")
cat("\n\n#------------ Any DQI_score differences between sex=0,1? --------------#\n\n")
mean_0 <- mean(df$DQI_score[df$sex_f31_0_0 == 0])
mean_1 <- mean(df$DQI_score[df$sex_f31_0_0 == 1])
cat("Mean DQI score for sex_f31_0_0 = 0:", mean_0, "\n")
cat("Mean DQI score for sex_f31_0_0 = 1:", mean_1, "\n\n")
wilcox.test(df$DQI_score[df$sex_f31_0_0 == 0], df$DQI_score[df$sex_f31_0_0 == 1], alternative = "two.sided")
cat("\n\n#------------ Any DQI_score differences between smoking status=0,1,2? --------------#\n\n")
mean_0 <- mean(df$DQI_score[df$smoking_status_f20116_0_0 == 0])
mean_1 <- mean(df$DQI_score[df$smoking_status_f20116_0_0 == 1])
mean_1 <- mean(df$DQI_score[df$smoking_status_f20116_0_0 == 2])
cat("Mean DQI score for smoking_status_f20116_0_0 = 0:", mean_0, "\n")
cat("Mean DQI score for smoking_status_f20116_0_0 = 1:", mean_1, "\n")
cat("Mean DQI score for smoking_status_f20116_0_0 = 1:", mean_2, "\n\n")
wilcox.test(df$DQI_score[df$smoking_status_f20116_0_0 == 0], df$DQI_score[df$smoking_status_f20116_0_0 == 1], alternative = "two.sided")
wilcox.test(df$DQI_score[df$smoking_status_f20116_0_0 == 0], df$DQI_score[df$smoking_status_f20116_0_0 == 2], alternative = "two.sided")
wilcox.test(df$DQI_score[df$smoking_status_f20116_0_0 == 1], df$DQI_score[df$smoking_status_f20116_0_0 == 2], alternative = "two.sided")
#----------------- Linear Regression -------------------#
cat("\n\n#----------------- Linear Regression -------------------#\n\n")
# fit a multivariable linear regression model
model <- lm(DQI_score ~ screen_time + sex_f31_0_0 + age_at_recruitment_f21022_0_0 +
total_met_minites_per_day + sleep_duration_f1160_0_0 + alcohol_intake_frequency_f1558_0_0 +
standing_height_f50_0_0 + weight_f21002_0_0 + frequency_of_friendfamily_visits_f1031_0_0 +
smoking_status_f20116_0_0, data = df)
# display the regression
cat("Analysis Results\n")
summary(model)
sink()
#----------------- Descriptive Statistics -------------------#
cat("\n\n#----------------- Descriptive Statistics -------------------#\n\n")
library(psych)
# subset the data by screen_time
screen0 <- subset(df, screen_time == 0)
screen1 <- subset(df, screen_time == 1)
# calculate descriptive statistics for screen_time=0
screen_time_0_desc <- describe(screen0[c("age_at_recruitment_f21022_0_0",
"total_met_minites_per_day",
"DQI_score",
"total_screen_hours_per_day",
"sleep_duration_f1160_0_0",
"alcohol_intake_frequency_f1558_0_0",
"standing_height_f50_0_0",
"weight_f21002_0_0",
"frequency_of_friendfamily_visits_f1031_0_0")])
# calculate descriptive statistics for screen_time=1
screen_time_1_desc <- describe(screen1[c("age_at_recruitment_f21022_0_0",
"total_met_minites_per_day",
"DQI_score",
"total_screen_hours_per_day",
"sleep_duration_f1160_0_0",
"alcohol_intake_frequency_f1558_0_0",
"standing_height_f50_0_0",
"weight_f21002_0_0",
"frequency_of_friendfamily_visits_f1031_0_0")])
# calculate percentage of females and smoke status in each group
percent_female_0 <- round(prop.table(table(screen0$sex_f31_0_0))["0"] * 100, 2)
percent_female_1 <- round(prop.table(table(screen1$sex_f31_0_0))["0"] * 100, 2)
percent_never_smoke_0 <- round(prop.table(table(screen0$smoking_status_f20116_0_0))["0"] * 100, 2)
percent_never_smoke_1 <- round(prop.table(table(screen1$smoking_status_f20116_0_0))["0"] * 100, 2)
percent_previous_smoke_0 <- round(prop.table(table(screen0$smoking_status_f20116_0_0))["1"] * 100, 2)
percent_previous_smoke_1 <- round(prop.table(table(screen1$smoking_status_f20116_0_0))["1"] * 100, 2)
percent_current_smoke_0 <- round(prop.table(table(screen0$smoking_status_f20116_0_0))["2"] * 100, 2)
percent_current_smoke_1 <- round(prop.table(table(screen1$smoking_status_f20116_0_0))["2"] * 100, 2)
# calculate descriptive statistics for screen_time=1
screen_time_desc <- describeBy(df[c("age_at_recruitment_f21022_0_0",
"total_met_minites_per_day",
"DQI_score",
"total_screen_hours_per_day",
"sleep_duration_f1160_0_0",
"alcohol_intake_frequency_f1558_0_0",
"standing_height_f50_0_0",
"weight_f21002_0_0",
"frequency_of_friendfamily_visits_f1031_0_0")],
df$screen_time,
mat=TRUE,
digits=2,
fast=TRUE)
# print the table and percentage of females
sink("aim1_results.txt")
cat("Group 0: screen time < 4hr per day \n")
cat("Group 1: screen time > 4hr per day \n")
screen_time_desc[, c(2, 4, 5, 6)] # display only mean and sd columns
cat("Group 0: Percentage of females: ", percent_female_0, "% \n")
cat("Group 1: Percentage of females: ", percent_female_1, "% \n")
cat("Group 0: Percentage of never smoke: ", percent_never_smoke_0, "% \n")
cat("Group 1: Percentage of never smoke: ", percent_never_smoke_1, "% \n")
cat("Group 0: Percentage of previous smoke: ", percent_previous_smoke_0, "% \n")
cat("Group 1: Percentage of previous smoke: ", percent_previous_smoke_1, "% \n")
cat("Group 0: Percentage of current smoke: ", percent_current_smoke_0, "% \n")
cat("Group 1: Percentage of current smoke: ", percent_current_smoke_1, "% \n")
#----------------- Hypothesis Testing -------------------#
cat("\n\n#----------------- Hypothesis Testing -------------------#\n\n")
cat("\n\n#------------ Any DQI_score differences between screen_time=0,1? --------------#\n\n")
hist(df$DQI_score)
# check normality using Kolmogorov-Smirnov test
ks.test(df$DQI_score, "pnorm", mean(df$DQI_score), sd(df$DQI_score))
# calculate the mean DQI score for each group
mean_0 <- mean(df$DQI_score[df$screen_time == 0])
mean_1 <- mean(df$DQI_score[df$screen_time == 1])
# print the mean DQI score for each group
cat("Mean DQI score for screen_time = 0:", mean_0, "\n")
cat("Mean DQI score for screen_time = 1:", mean_1, "\n\n")
# conduct Mann-Whitney U test and save the results to a local file
wilcox.test(df$DQI_score[df$screen_time == 0], df$DQI_score[df$screen_time == 1], alternative = "two.sided")
cat("\n\n#------------ Any DQI_score differences between sex=0,1? --------------#\n\n")
mean_0 <- mean(df$DQI_score[df$sex_f31_0_0 == 0])
mean_1 <- mean(df$DQI_score[df$sex_f31_0_0 == 1])
cat("Mean DQI score for sex_f31_0_0 = 0:", mean_0, "\n")
cat("Mean DQI score for sex_f31_0_0 = 1:", mean_1, "\n\n")
wilcox.test(df$DQI_score[df$sex_f31_0_0 == 0], df$DQI_score[df$sex_f31_0_0 == 1], alternative = "two.sided")
cat("\n\n#------------ Any DQI_score differences between smoking status=0,1,2? --------------#\n\n")
mean_0 <- mean(df$DQI_score[df$smoking_status_f20116_0_0 == 0])
mean_1 <- mean(df$DQI_score[df$smoking_status_f20116_0_0 == 1])
mean_1 <- mean(df$DQI_score[df$smoking_status_f20116_0_0 == 2])
cat("Mean DQI score for smoking_status_f20116_0_0 = 0:", mean_0, "\n")
cat("Mean DQI score for smoking_status_f20116_0_0 = 1:", mean_1, "\n")
cat("Mean DQI score for smoking_status_f20116_0_0 = 1:", mean_2, "\n\n")
wilcox.test(df$DQI_score[df$smoking_status_f20116_0_0 == 0], df$DQI_score[df$smoking_status_f20116_0_0 == 1], alternative = "two.sided")
wilcox.test(df$DQI_score[df$smoking_status_f20116_0_0 == 0], df$DQI_score[df$smoking_status_f20116_0_0 == 2], alternative = "two.sided")
wilcox.test(df$DQI_score[df$smoking_status_f20116_0_0 == 1], df$DQI_score[df$smoking_status_f20116_0_0 == 2], alternative = "two.sided")
#----------------- Linear Regression -------------------#
cat("\n\n#----------------- Linear Regression -------------------#\n\n")
# fit a multivariable linear regression model
model <- lm(DQI_score ~ screen_time + sex_f31_0_0 + age_at_recruitment_f21022_0_0 +
total_met_minites_per_day + sleep_duration_f1160_0_0 + alcohol_intake_frequency_f1558_0_0 +
standing_height_f50_0_0 + weight_f21002_0_0 + frequency_of_friendfamily_visits_f1031_0_0 +
smoking_status_f20116_0_0, data = df)
# display the regression
cat("Analysis Results\n")
summary(model)
sink()
#----------------- Descriptive Statistics -------------------#
cat("\n\n#----------------- Descriptive Statistics -------------------#\n\n")
library(psych)
# subset the data by screen_time
screen0 <- subset(df, screen_time == 0)
screen1 <- subset(df, screen_time == 1)
# calculate descriptive statistics for screen_time=0
screen_time_0_desc <- describe(screen0[c("age_at_recruitment_f21022_0_0",
"total_met_minites_per_day",
"DQI_score",
"total_screen_hours_per_day",
"sleep_duration_f1160_0_0",
"alcohol_intake_frequency_f1558_0_0",
"standing_height_f50_0_0",
"weight_f21002_0_0",
"frequency_of_friendfamily_visits_f1031_0_0")])
# calculate descriptive statistics for screen_time=1
screen_time_1_desc <- describe(screen1[c("age_at_recruitment_f21022_0_0",
"total_met_minites_per_day",
"DQI_score",
"total_screen_hours_per_day",
"sleep_duration_f1160_0_0",
"alcohol_intake_frequency_f1558_0_0",
"standing_height_f50_0_0",
"weight_f21002_0_0",
"frequency_of_friendfamily_visits_f1031_0_0")])
# calculate percentage of females and smoke status in each group
percent_female_0 <- round(prop.table(table(screen0$sex_f31_0_0))["0"] * 100, 2)
percent_female_1 <- round(prop.table(table(screen1$sex_f31_0_0))["0"] * 100, 2)
percent_never_smoke_0 <- round(prop.table(table(screen0$smoking_status_f20116_0_0))["0"] * 100, 2)
percent_never_smoke_1 <- round(prop.table(table(screen1$smoking_status_f20116_0_0))["0"] * 100, 2)
percent_previous_smoke_0 <- round(prop.table(table(screen0$smoking_status_f20116_0_0))["1"] * 100, 2)
percent_previous_smoke_1 <- round(prop.table(table(screen1$smoking_status_f20116_0_0))["1"] * 100, 2)
percent_current_smoke_0 <- round(prop.table(table(screen0$smoking_status_f20116_0_0))["2"] * 100, 2)
percent_current_smoke_1 <- round(prop.table(table(screen1$smoking_status_f20116_0_0))["2"] * 100, 2)
# calculate descriptive statistics for screen_time=1
screen_time_desc <- describeBy(df[c("age_at_recruitment_f21022_0_0",
"total_met_minites_per_day",
"DQI_score",
"total_screen_hours_per_day",
"sleep_duration_f1160_0_0",
"alcohol_intake_frequency_f1558_0_0",
"standing_height_f50_0_0",
"weight_f21002_0_0",
"frequency_of_friendfamily_visits_f1031_0_0")],
df$screen_time,
mat=TRUE,
digits=2,
fast=TRUE)
# print the table and percentage of females
sink("aim1_results.txt")
cat("Group 0: screen time < 4hr per day \n")
cat("Group 1: screen time > 4hr per day \n")
screen_time_desc[, c(2, 4, 5, 6)] # display only mean and sd columns
cat("Group 0: Percentage of females: ", percent_female_0, "% \n")
cat("Group 1: Percentage of females: ", percent_female_1, "% \n")
cat("Group 0: Percentage of never smoke: ", percent_never_smoke_0, "% \n")
cat("Group 1: Percentage of never smoke: ", percent_never_smoke_1, "% \n")
cat("Group 0: Percentage of previous smoke: ", percent_previous_smoke_0, "% \n")
cat("Group 1: Percentage of previous smoke: ", percent_previous_smoke_1, "% \n")
cat("Group 0: Percentage of current smoke: ", percent_current_smoke_0, "% \n")
cat("Group 1: Percentage of current smoke: ", percent_current_smoke_1, "% \n")
#----------------- Hypothesis Testing -------------------#
cat("\n\n#----------------- Hypothesis Testing -------------------#\n\n")
cat("\n\n#------------ Any DQI_score differences between screen_time=0,1? --------------#\n\n")
hist(df$DQI_score)
# check normality using Kolmogorov-Smirnov test
ks.test(df$DQI_score, "pnorm", mean(df$DQI_score), sd(df$DQI_score))
# calculate the mean DQI score for each group
mean_0 <- mean(df$DQI_score[df$screen_time == 0])
mean_1 <- mean(df$DQI_score[df$screen_time == 1])
# print the mean DQI score for each group
cat("Mean DQI score for screen_time = 0:", mean_0, "\n")
cat("Mean DQI score for screen_time = 1:", mean_1, "\n\n")
# conduct Mann-Whitney U test and save the results to a local file
wilcox.test(df$DQI_score[df$screen_time == 0], df$DQI_score[df$screen_time == 1], alternative = "two.sided")
cat("\n\n#------------ Any DQI_score differences between sex=0,1? --------------#\n\n")
mean_0 <- mean(df$DQI_score[df$sex_f31_0_0 == 0])
mean_1 <- mean(df$DQI_score[df$sex_f31_0_0 == 1])
cat("Mean DQI score for sex_f31_0_0 = 0:", mean_0, "\n")
cat("Mean DQI score for sex_f31_0_0 = 1:", mean_1, "\n\n")
wilcox.test(df$DQI_score[df$sex_f31_0_0 == 0], df$DQI_score[df$sex_f31_0_0 == 1], alternative = "two.sided")
cat("\n\n#------------ Any DQI_score differences between smoking status=0,1,2? --------------#\n\n")
mean_0 <- mean(df$DQI_score[df$smoking_status_f20116_0_0 == 0])
mean_1 <- mean(df$DQI_score[df$smoking_status_f20116_0_0 == 1])
mean_2 <- mean(df$DQI_score[df$smoking_status_f20116_0_0 == 2])
cat("Mean DQI score for smoking_status_f20116_0_0 = 0:", mean_0, "\n")
cat("Mean DQI score for smoking_status_f20116_0_0 = 1:", mean_1, "\n")
cat("Mean DQI score for smoking_status_f20116_0_0 = 1:", mean_2, "\n\n")
wilcox.test(df$DQI_score[df$smoking_status_f20116_0_0 == 0], df$DQI_score[df$smoking_status_f20116_0_0 == 1], alternative = "two.sided")
wilcox.test(df$DQI_score[df$smoking_status_f20116_0_0 == 0], df$DQI_score[df$smoking_status_f20116_0_0 == 2], alternative = "two.sided")
wilcox.test(df$DQI_score[df$smoking_status_f20116_0_0 == 1], df$DQI_score[df$smoking_status_f20116_0_0 == 2], alternative = "two.sided")
#----------------- Linear Regression -------------------#
cat("\n\n#----------------- Linear Regression -------------------#\n\n")
# fit a multivariable linear regression model
model <- lm(DQI_score ~ screen_time + sex_f31_0_0 + age_at_recruitment_f21022_0_0 +
total_met_minites_per_day + sleep_duration_f1160_0_0 + alcohol_intake_frequency_f1558_0_0 +
standing_height_f50_0_0 + weight_f21002_0_0 + frequency_of_friendfamily_visits_f1031_0_0 +
smoking_status_f20116_0_0, data = df)
# display the regression
cat("Analysis Results\n")
summary(model)
sink()
